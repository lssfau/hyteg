/*
 * Copyright (c) 2022 Daniel Bauer.
 *
 * This file is part of HyTeG
 * (see https://i10git.cs.fau.de/hyteg/hyteg).
 *
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with this program. If not, see <http://www.gnu.org/licenses/>.
 */
#pragma once

#include "hyteg/forms/N1E1Form.hpp"

using walberla::real_c;

namespace hyteg {
namespace n1e1 {

class N1E1Form_mass : public N1E1Form
{
 public:
   /// Edges are in FEniCS ordering:
   ///
   /// 3
   /// |\`\.
   /// | 0 `\.
   /// |  \   1
   /// 3  2 _  `\.
   /// |  /  `-2 `\.
   /// | 4      `\_`\
   /// 0------5------1
   void integrateAll( const std::array< Point3D, 4 >& coords, Matrix6r& elMat ) const final
   {
      elMat.setAll( real_c( 0 ) );

      // F maps from reference tet K̂ to affine tet K
      // K = F(K̂) = Bx̂ + b
      // B is the Jacobian of the transformation
      Eigen::Matrix3d B;
      B.col( 0 ) = toEigen( coords[1] - coords[0] );
      B.col( 1 ) = toEigen( coords[2] - coords[0] );
      B.col( 2 ) = toEigen( coords[3] - coords[0] );

      const real_t absDetB = std::abs( B.determinant() );

      const Eigen::Matrix3d b    = B.inverse();
      const real_t          b_11 = b( 0, 0 );
      const real_t          b_12 = b( 0, 1 );
      const real_t          b_13 = b( 0, 2 );
      const real_t          b_21 = b( 1, 0 );
      const real_t          b_22 = b( 1, 1 );
      const real_t          b_23 = b( 1, 2 );
      const real_t          b_31 = b( 2, 0 );
      const real_t          b_32 = b( 2, 1 );
      const real_t          b_33 = b( 2, 2 );

      // clang-format off
      elMat(0,0) = absDetB*((1.0/60.0)*std::pow(b_21, 2) - 1.0/60.0*b_21*b_31 + (1.0/60.0)*std::pow(b_22, 2) - 1.0/60.0*b_22*b_32 + (1.0/60.0)*std::pow(b_23, 2) - 1.0/60.0*b_23*b_33 + (1.0/60.0)*std::pow(b_31, 2) + (1.0/60.0)*std::pow(b_32, 2) + (1.0/60.0)*std::pow(b_33, 2));
      elMat(0,1) = absDetB*((1.0/60.0)*b_11*b_21 - 1.0/120.0*b_11*b_31 + (1.0/60.0)*b_12*b_22 - 1.0/120.0*b_12*b_32 + (1.0/60.0)*b_13*b_23 - 1.0/120.0*b_13*b_33 - 1.0/120.0*b_21*b_31 - 1.0/120.0*b_22*b_32 - 1.0/120.0*b_23*b_33 + (1.0/120.0)*std::pow(b_31, 2) + (1.0/120.0)*std::pow(b_32, 2) + (1.0/120.0)*std::pow(b_33, 2));
      elMat(0,2) = absDetB*((1.0/120.0)*b_11*b_21 - 1.0/60.0*b_11*b_31 + (1.0/120.0)*b_12*b_22 - 1.0/60.0*b_12*b_32 + (1.0/120.0)*b_13*b_23 - 1.0/60.0*b_13*b_33 - 1.0/120.0*std::pow(b_21, 2) + (1.0/120.0)*b_21*b_31 - 1.0/120.0*std::pow(b_22, 2) + (1.0/120.0)*b_22*b_32 - 1.0/120.0*std::pow(b_23, 2) + (1.0/120.0)*b_23*b_33);
      elMat(0,3) = absDetB*(-1.0/60.0*b_11*b_21 + (1.0/120.0)*b_11*b_31 - 1.0/60.0*b_12*b_22 + (1.0/120.0)*b_12*b_32 - 1.0/60.0*b_13*b_23 + (1.0/120.0)*b_13*b_33 - 1.0/60.0*std::pow(b_21, 2) - 1.0/60.0*b_21*b_31 - 1.0/60.0*std::pow(b_22, 2) - 1.0/60.0*b_22*b_32 - 1.0/60.0*std::pow(b_23, 2) - 1.0/60.0*b_23*b_33 + (1.0/60.0)*std::pow(b_31, 2) + (1.0/60.0)*std::pow(b_32, 2) + (1.0/60.0)*std::pow(b_33, 2));
      elMat(0,4) = absDetB*(-1.0/120.0*b_11*b_21 + (1.0/60.0)*b_11*b_31 - 1.0/120.0*b_12*b_22 + (1.0/60.0)*b_12*b_32 - 1.0/120.0*b_13*b_23 + (1.0/60.0)*b_13*b_33 - 1.0/60.0*std::pow(b_21, 2) + (1.0/60.0)*b_21*b_31 - 1.0/60.0*std::pow(b_22, 2) + (1.0/60.0)*b_22*b_32 - 1.0/60.0*std::pow(b_23, 2) + (1.0/60.0)*b_23*b_33 + (1.0/60.0)*std::pow(b_31, 2) + (1.0/60.0)*std::pow(b_32, 2) + (1.0/60.0)*std::pow(b_33, 2));
      elMat(0,5) = absDetB*(-1.0/60.0*b_11*b_21 + (1.0/60.0)*b_11*b_31 - 1.0/60.0*b_12*b_22 + (1.0/60.0)*b_12*b_32 - 1.0/60.0*b_13*b_23 + (1.0/60.0)*b_13*b_33 - 1.0/120.0*std::pow(b_21, 2) - 1.0/120.0*std::pow(b_22, 2) - 1.0/120.0*std::pow(b_23, 2) + (1.0/120.0)*std::pow(b_31, 2) + (1.0/120.0)*std::pow(b_32, 2) + (1.0/120.0)*std::pow(b_33, 2));
      elMat(1,0) = absDetB*((1.0/60.0)*b_11*b_21 - 1.0/120.0*b_11*b_31 + (1.0/60.0)*b_12*b_22 - 1.0/120.0*b_12*b_32 + (1.0/60.0)*b_13*b_23 - 1.0/120.0*b_13*b_33 - 1.0/120.0*b_21*b_31 - 1.0/120.0*b_22*b_32 - 1.0/120.0*b_23*b_33 + (1.0/120.0)*std::pow(b_31, 2) + (1.0/120.0)*std::pow(b_32, 2) + (1.0/120.0)*std::pow(b_33, 2));
      elMat(1,1) = absDetB*((1.0/60.0)*std::pow(b_11, 2) - 1.0/60.0*b_11*b_31 + (1.0/60.0)*std::pow(b_12, 2) - 1.0/60.0*b_12*b_32 + (1.0/60.0)*std::pow(b_13, 2) - 1.0/60.0*b_13*b_33 + (1.0/60.0)*std::pow(b_31, 2) + (1.0/60.0)*std::pow(b_32, 2) + (1.0/60.0)*std::pow(b_33, 2));
      elMat(1,2) = absDetB*((1.0/120.0)*std::pow(b_11, 2) - 1.0/120.0*b_11*b_21 - 1.0/120.0*b_11*b_31 + (1.0/120.0)*std::pow(b_12, 2) - 1.0/120.0*b_12*b_22 - 1.0/120.0*b_12*b_32 + (1.0/120.0)*std::pow(b_13, 2) - 1.0/120.0*b_13*b_23 - 1.0/120.0*b_13*b_33 + (1.0/60.0)*b_21*b_31 + (1.0/60.0)*b_22*b_32 + (1.0/60.0)*b_23*b_33);
      elMat(1,3) = absDetB*(-1.0/60.0*std::pow(b_11, 2) - 1.0/60.0*b_11*b_21 - 1.0/60.0*b_11*b_31 - 1.0/60.0*std::pow(b_12, 2) - 1.0/60.0*b_12*b_22 - 1.0/60.0*b_12*b_32 - 1.0/60.0*std::pow(b_13, 2) - 1.0/60.0*b_13*b_23 - 1.0/60.0*b_13*b_33 + (1.0/120.0)*b_21*b_31 + (1.0/120.0)*b_22*b_32 + (1.0/120.0)*b_23*b_33 + (1.0/60.0)*std::pow(b_31, 2) + (1.0/60.0)*std::pow(b_32, 2) + (1.0/60.0)*std::pow(b_33, 2));
      elMat(1,4) = absDetB*(-1.0/120.0*std::pow(b_11, 2) - 1.0/60.0*b_11*b_21 - 1.0/120.0*std::pow(b_12, 2) - 1.0/60.0*b_12*b_22 - 1.0/120.0*std::pow(b_13, 2) - 1.0/60.0*b_13*b_23 + (1.0/60.0)*b_21*b_31 + (1.0/60.0)*b_22*b_32 + (1.0/60.0)*b_23*b_33 + (1.0/120.0)*std::pow(b_31, 2) + (1.0/120.0)*std::pow(b_32, 2) + (1.0/120.0)*std::pow(b_33, 2));
      elMat(1,5) = absDetB*(-1.0/60.0*std::pow(b_11, 2) - 1.0/120.0*b_11*b_21 + (1.0/60.0)*b_11*b_31 - 1.0/60.0*std::pow(b_12, 2) - 1.0/120.0*b_12*b_22 + (1.0/60.0)*b_12*b_32 - 1.0/60.0*std::pow(b_13, 2) - 1.0/120.0*b_13*b_23 + (1.0/60.0)*b_13*b_33 + (1.0/60.0)*b_21*b_31 + (1.0/60.0)*b_22*b_32 + (1.0/60.0)*b_23*b_33 + (1.0/60.0)*std::pow(b_31, 2) + (1.0/60.0)*std::pow(b_32, 2) + (1.0/60.0)*std::pow(b_33, 2));
      elMat(2,0) = absDetB*((1.0/120.0)*b_11*b_21 - 1.0/60.0*b_11*b_31 + (1.0/120.0)*b_12*b_22 - 1.0/60.0*b_12*b_32 + (1.0/120.0)*b_13*b_23 - 1.0/60.0*b_13*b_33 - 1.0/120.0*std::pow(b_21, 2) + (1.0/120.0)*b_21*b_31 - 1.0/120.0*std::pow(b_22, 2) + (1.0/120.0)*b_22*b_32 - 1.0/120.0*std::pow(b_23, 2) + (1.0/120.0)*b_23*b_33);
      elMat(2,1) = absDetB*((1.0/120.0)*std::pow(b_11, 2) - 1.0/120.0*b_11*b_21 - 1.0/120.0*b_11*b_31 + (1.0/120.0)*std::pow(b_12, 2) - 1.0/120.0*b_12*b_22 - 1.0/120.0*b_12*b_32 + (1.0/120.0)*std::pow(b_13, 2) - 1.0/120.0*b_13*b_23 - 1.0/120.0*b_13*b_33 + (1.0/60.0)*b_21*b_31 + (1.0/60.0)*b_22*b_32 + (1.0/60.0)*b_23*b_33);
      elMat(2,2) = absDetB*((1.0/60.0)*std::pow(b_11, 2) - 1.0/60.0*b_11*b_21 + (1.0/60.0)*std::pow(b_12, 2) - 1.0/60.0*b_12*b_22 + (1.0/60.0)*std::pow(b_13, 2) - 1.0/60.0*b_13*b_23 + (1.0/60.0)*std::pow(b_21, 2) + (1.0/60.0)*std::pow(b_22, 2) + (1.0/60.0)*std::pow(b_23, 2));
      elMat(2,3) = absDetB*(-1.0/120.0*std::pow(b_11, 2) - 1.0/60.0*b_11*b_31 - 1.0/120.0*std::pow(b_12, 2) - 1.0/60.0*b_12*b_32 - 1.0/120.0*std::pow(b_13, 2) - 1.0/60.0*b_13*b_33 + (1.0/120.0)*std::pow(b_21, 2) + (1.0/60.0)*b_21*b_31 + (1.0/120.0)*std::pow(b_22, 2) + (1.0/60.0)*b_22*b_32 + (1.0/120.0)*std::pow(b_23, 2) + (1.0/60.0)*b_23*b_33);
      elMat(2,4) = absDetB*(-1.0/60.0*std::pow(b_11, 2) - 1.0/60.0*b_11*b_21 - 1.0/60.0*b_11*b_31 - 1.0/60.0*std::pow(b_12, 2) - 1.0/60.0*b_12*b_22 - 1.0/60.0*b_12*b_32 - 1.0/60.0*std::pow(b_13, 2) - 1.0/60.0*b_13*b_23 - 1.0/60.0*b_13*b_33 + (1.0/60.0)*std::pow(b_21, 2) + (1.0/120.0)*b_21*b_31 + (1.0/60.0)*std::pow(b_22, 2) + (1.0/120.0)*b_22*b_32 + (1.0/60.0)*std::pow(b_23, 2) + (1.0/120.0)*b_23*b_33);
      elMat(2,5) = absDetB*(-1.0/60.0*std::pow(b_11, 2) + (1.0/60.0)*b_11*b_21 - 1.0/120.0*b_11*b_31 - 1.0/60.0*std::pow(b_12, 2) + (1.0/60.0)*b_12*b_22 - 1.0/120.0*b_12*b_32 - 1.0/60.0*std::pow(b_13, 2) + (1.0/60.0)*b_13*b_23 - 1.0/120.0*b_13*b_33 + (1.0/60.0)*std::pow(b_21, 2) + (1.0/60.0)*b_21*b_31 + (1.0/60.0)*std::pow(b_22, 2) + (1.0/60.0)*b_22*b_32 + (1.0/60.0)*std::pow(b_23, 2) + (1.0/60.0)*b_23*b_33);
      elMat(3,0) = absDetB*(-1.0/60.0*b_11*b_21 + (1.0/120.0)*b_11*b_31 - 1.0/60.0*b_12*b_22 + (1.0/120.0)*b_12*b_32 - 1.0/60.0*b_13*b_23 + (1.0/120.0)*b_13*b_33 - 1.0/60.0*std::pow(b_21, 2) - 1.0/60.0*b_21*b_31 - 1.0/60.0*std::pow(b_22, 2) - 1.0/60.0*b_22*b_32 - 1.0/60.0*std::pow(b_23, 2) - 1.0/60.0*b_23*b_33 + (1.0/60.0)*std::pow(b_31, 2) + (1.0/60.0)*std::pow(b_32, 2) + (1.0/60.0)*std::pow(b_33, 2));
      elMat(3,1) = absDetB*(-1.0/60.0*std::pow(b_11, 2) - 1.0/60.0*b_11*b_21 - 1.0/60.0*b_11*b_31 - 1.0/60.0*std::pow(b_12, 2) - 1.0/60.0*b_12*b_22 - 1.0/60.0*b_12*b_32 - 1.0/60.0*std::pow(b_13, 2) - 1.0/60.0*b_13*b_23 - 1.0/60.0*b_13*b_33 + (1.0/120.0)*b_21*b_31 + (1.0/120.0)*b_22*b_32 + (1.0/120.0)*b_23*b_33 + (1.0/60.0)*std::pow(b_31, 2) + (1.0/60.0)*std::pow(b_32, 2) + (1.0/60.0)*std::pow(b_33, 2));
      elMat(3,2) = absDetB*(-1.0/120.0*std::pow(b_11, 2) - 1.0/60.0*b_11*b_31 - 1.0/120.0*std::pow(b_12, 2) - 1.0/60.0*b_12*b_32 - 1.0/120.0*std::pow(b_13, 2) - 1.0/60.0*b_13*b_33 + (1.0/120.0)*std::pow(b_21, 2) + (1.0/60.0)*b_21*b_31 + (1.0/120.0)*std::pow(b_22, 2) + (1.0/60.0)*b_22*b_32 + (1.0/120.0)*std::pow(b_23, 2) + (1.0/60.0)*b_23*b_33);
      elMat(3,3) = absDetB*((1.0/60.0)*std::pow(b_11, 2) + (1.0/30.0)*b_11*b_21 + (1.0/20.0)*b_11*b_31 + (1.0/60.0)*std::pow(b_12, 2) + (1.0/30.0)*b_12*b_22 + (1.0/20.0)*b_12*b_32 + (1.0/60.0)*std::pow(b_13, 2) + (1.0/30.0)*b_13*b_23 + (1.0/20.0)*b_13*b_33 + (1.0/60.0)*std::pow(b_21, 2) + (1.0/20.0)*b_21*b_31 + (1.0/60.0)*std::pow(b_22, 2) + (1.0/20.0)*b_22*b_32 + (1.0/60.0)*std::pow(b_23, 2) + (1.0/20.0)*b_23*b_33 + (1.0/20.0)*std::pow(b_31, 2) + (1.0/20.0)*std::pow(b_32, 2) + (1.0/20.0)*std::pow(b_33, 2));
      elMat(3,4) = absDetB*((1.0/120.0)*std::pow(b_11, 2) + (1.0/40.0)*b_11*b_21 + (1.0/40.0)*b_11*b_31 + (1.0/120.0)*std::pow(b_12, 2) + (1.0/40.0)*b_12*b_22 + (1.0/40.0)*b_12*b_32 + (1.0/120.0)*std::pow(b_13, 2) + (1.0/40.0)*b_13*b_23 + (1.0/40.0)*b_13*b_33 + (1.0/60.0)*std::pow(b_21, 2) + (1.0/20.0)*b_21*b_31 + (1.0/60.0)*std::pow(b_22, 2) + (1.0/20.0)*b_22*b_32 + (1.0/60.0)*std::pow(b_23, 2) + (1.0/20.0)*b_23*b_33 + (1.0/60.0)*std::pow(b_31, 2) + (1.0/60.0)*std::pow(b_32, 2) + (1.0/60.0)*std::pow(b_33, 2));
      elMat(3,5) = absDetB*((1.0/60.0)*std::pow(b_11, 2) + (1.0/40.0)*b_11*b_21 + (1.0/20.0)*b_11*b_31 + (1.0/60.0)*std::pow(b_12, 2) + (1.0/40.0)*b_12*b_22 + (1.0/20.0)*b_12*b_32 + (1.0/60.0)*std::pow(b_13, 2) + (1.0/40.0)*b_13*b_23 + (1.0/20.0)*b_13*b_33 + (1.0/120.0)*std::pow(b_21, 2) + (1.0/40.0)*b_21*b_31 + (1.0/120.0)*std::pow(b_22, 2) + (1.0/40.0)*b_22*b_32 + (1.0/120.0)*std::pow(b_23, 2) + (1.0/40.0)*b_23*b_33 + (1.0/60.0)*std::pow(b_31, 2) + (1.0/60.0)*std::pow(b_32, 2) + (1.0/60.0)*std::pow(b_33, 2));
      elMat(4,0) = absDetB*(-1.0/120.0*b_11*b_21 + (1.0/60.0)*b_11*b_31 - 1.0/120.0*b_12*b_22 + (1.0/60.0)*b_12*b_32 - 1.0/120.0*b_13*b_23 + (1.0/60.0)*b_13*b_33 - 1.0/60.0*std::pow(b_21, 2) + (1.0/60.0)*b_21*b_31 - 1.0/60.0*std::pow(b_22, 2) + (1.0/60.0)*b_22*b_32 - 1.0/60.0*std::pow(b_23, 2) + (1.0/60.0)*b_23*b_33 + (1.0/60.0)*std::pow(b_31, 2) + (1.0/60.0)*std::pow(b_32, 2) + (1.0/60.0)*std::pow(b_33, 2));
      elMat(4,1) = absDetB*(-1.0/120.0*std::pow(b_11, 2) - 1.0/60.0*b_11*b_21 - 1.0/120.0*std::pow(b_12, 2) - 1.0/60.0*b_12*b_22 - 1.0/120.0*std::pow(b_13, 2) - 1.0/60.0*b_13*b_23 + (1.0/60.0)*b_21*b_31 + (1.0/60.0)*b_22*b_32 + (1.0/60.0)*b_23*b_33 + (1.0/120.0)*std::pow(b_31, 2) + (1.0/120.0)*std::pow(b_32, 2) + (1.0/120.0)*std::pow(b_33, 2));
      elMat(4,2) = absDetB*(-1.0/60.0*std::pow(b_11, 2) - 1.0/60.0*b_11*b_21 - 1.0/60.0*b_11*b_31 - 1.0/60.0*std::pow(b_12, 2) - 1.0/60.0*b_12*b_22 - 1.0/60.0*b_12*b_32 - 1.0/60.0*std::pow(b_13, 2) - 1.0/60.0*b_13*b_23 - 1.0/60.0*b_13*b_33 + (1.0/60.0)*std::pow(b_21, 2) + (1.0/120.0)*b_21*b_31 + (1.0/60.0)*std::pow(b_22, 2) + (1.0/120.0)*b_22*b_32 + (1.0/60.0)*std::pow(b_23, 2) + (1.0/120.0)*b_23*b_33);
      elMat(4,3) = absDetB*((1.0/120.0)*std::pow(b_11, 2) + (1.0/40.0)*b_11*b_21 + (1.0/40.0)*b_11*b_31 + (1.0/120.0)*std::pow(b_12, 2) + (1.0/40.0)*b_12*b_22 + (1.0/40.0)*b_12*b_32 + (1.0/120.0)*std::pow(b_13, 2) + (1.0/40.0)*b_13*b_23 + (1.0/40.0)*b_13*b_33 + (1.0/60.0)*std::pow(b_21, 2) + (1.0/20.0)*b_21*b_31 + (1.0/60.0)*std::pow(b_22, 2) + (1.0/20.0)*b_22*b_32 + (1.0/60.0)*std::pow(b_23, 2) + (1.0/20.0)*b_23*b_33 + (1.0/60.0)*std::pow(b_31, 2) + (1.0/60.0)*std::pow(b_32, 2) + (1.0/60.0)*std::pow(b_33, 2));
      elMat(4,4) = absDetB*((1.0/60.0)*std::pow(b_11, 2) + (1.0/20.0)*b_11*b_21 + (1.0/30.0)*b_11*b_31 + (1.0/60.0)*std::pow(b_12, 2) + (1.0/20.0)*b_12*b_22 + (1.0/30.0)*b_12*b_32 + (1.0/60.0)*std::pow(b_13, 2) + (1.0/20.0)*b_13*b_23 + (1.0/30.0)*b_13*b_33 + (1.0/20.0)*std::pow(b_21, 2) + (1.0/20.0)*b_21*b_31 + (1.0/20.0)*std::pow(b_22, 2) + (1.0/20.0)*b_22*b_32 + (1.0/20.0)*std::pow(b_23, 2) + (1.0/20.0)*b_23*b_33 + (1.0/60.0)*std::pow(b_31, 2) + (1.0/60.0)*std::pow(b_32, 2) + (1.0/60.0)*std::pow(b_33, 2));
      elMat(4,5) = absDetB*((1.0/60.0)*std::pow(b_11, 2) + (1.0/20.0)*b_11*b_21 + (1.0/40.0)*b_11*b_31 + (1.0/60.0)*std::pow(b_12, 2) + (1.0/20.0)*b_12*b_22 + (1.0/40.0)*b_12*b_32 + (1.0/60.0)*std::pow(b_13, 2) + (1.0/20.0)*b_13*b_23 + (1.0/40.0)*b_13*b_33 + (1.0/60.0)*std::pow(b_21, 2) + (1.0/40.0)*b_21*b_31 + (1.0/60.0)*std::pow(b_22, 2) + (1.0/40.0)*b_22*b_32 + (1.0/60.0)*std::pow(b_23, 2) + (1.0/40.0)*b_23*b_33 + (1.0/120.0)*std::pow(b_31, 2) + (1.0/120.0)*std::pow(b_32, 2) + (1.0/120.0)*std::pow(b_33, 2));
      elMat(5,0) = absDetB*(-1.0/60.0*b_11*b_21 + (1.0/60.0)*b_11*b_31 - 1.0/60.0*b_12*b_22 + (1.0/60.0)*b_12*b_32 - 1.0/60.0*b_13*b_23 + (1.0/60.0)*b_13*b_33 - 1.0/120.0*std::pow(b_21, 2) - 1.0/120.0*std::pow(b_22, 2) - 1.0/120.0*std::pow(b_23, 2) + (1.0/120.0)*std::pow(b_31, 2) + (1.0/120.0)*std::pow(b_32, 2) + (1.0/120.0)*std::pow(b_33, 2));
      elMat(5,1) = absDetB*(-1.0/60.0*std::pow(b_11, 2) - 1.0/120.0*b_11*b_21 + (1.0/60.0)*b_11*b_31 - 1.0/60.0*std::pow(b_12, 2) - 1.0/120.0*b_12*b_22 + (1.0/60.0)*b_12*b_32 - 1.0/60.0*std::pow(b_13, 2) - 1.0/120.0*b_13*b_23 + (1.0/60.0)*b_13*b_33 + (1.0/60.0)*b_21*b_31 + (1.0/60.0)*b_22*b_32 + (1.0/60.0)*b_23*b_33 + (1.0/60.0)*std::pow(b_31, 2) + (1.0/60.0)*std::pow(b_32, 2) + (1.0/60.0)*std::pow(b_33, 2));
      elMat(5,2) = absDetB*(-1.0/60.0*std::pow(b_11, 2) + (1.0/60.0)*b_11*b_21 - 1.0/120.0*b_11*b_31 - 1.0/60.0*std::pow(b_12, 2) + (1.0/60.0)*b_12*b_22 - 1.0/120.0*b_12*b_32 - 1.0/60.0*std::pow(b_13, 2) + (1.0/60.0)*b_13*b_23 - 1.0/120.0*b_13*b_33 + (1.0/60.0)*std::pow(b_21, 2) + (1.0/60.0)*b_21*b_31 + (1.0/60.0)*std::pow(b_22, 2) + (1.0/60.0)*b_22*b_32 + (1.0/60.0)*std::pow(b_23, 2) + (1.0/60.0)*b_23*b_33);
      elMat(5,3) = absDetB*((1.0/60.0)*std::pow(b_11, 2) + (1.0/40.0)*b_11*b_21 + (1.0/20.0)*b_11*b_31 + (1.0/60.0)*std::pow(b_12, 2) + (1.0/40.0)*b_12*b_22 + (1.0/20.0)*b_12*b_32 + (1.0/60.0)*std::pow(b_13, 2) + (1.0/40.0)*b_13*b_23 + (1.0/20.0)*b_13*b_33 + (1.0/120.0)*std::pow(b_21, 2) + (1.0/40.0)*b_21*b_31 + (1.0/120.0)*std::pow(b_22, 2) + (1.0/40.0)*b_22*b_32 + (1.0/120.0)*std::pow(b_23, 2) + (1.0/40.0)*b_23*b_33 + (1.0/60.0)*std::pow(b_31, 2) + (1.0/60.0)*std::pow(b_32, 2) + (1.0/60.0)*std::pow(b_33, 2));
      elMat(5,4) = absDetB*((1.0/60.0)*std::pow(b_11, 2) + (1.0/20.0)*b_11*b_21 + (1.0/40.0)*b_11*b_31 + (1.0/60.0)*std::pow(b_12, 2) + (1.0/20.0)*b_12*b_22 + (1.0/40.0)*b_12*b_32 + (1.0/60.0)*std::pow(b_13, 2) + (1.0/20.0)*b_13*b_23 + (1.0/40.0)*b_13*b_33 + (1.0/60.0)*std::pow(b_21, 2) + (1.0/40.0)*b_21*b_31 + (1.0/60.0)*std::pow(b_22, 2) + (1.0/40.0)*b_22*b_32 + (1.0/60.0)*std::pow(b_23, 2) + (1.0/40.0)*b_23*b_33 + (1.0/120.0)*std::pow(b_31, 2) + (1.0/120.0)*std::pow(b_32, 2) + (1.0/120.0)*std::pow(b_33, 2));
      elMat(5,5) = absDetB*((1.0/20.0)*std::pow(b_11, 2) + (1.0/20.0)*b_11*b_21 + (1.0/20.0)*b_11*b_31 + (1.0/20.0)*std::pow(b_12, 2) + (1.0/20.0)*b_12*b_22 + (1.0/20.0)*b_12*b_32 + (1.0/20.0)*std::pow(b_13, 2) + (1.0/20.0)*b_13*b_23 + (1.0/20.0)*b_13*b_33 + (1.0/60.0)*std::pow(b_21, 2) + (1.0/30.0)*b_21*b_31 + (1.0/60.0)*std::pow(b_22, 2) + (1.0/30.0)*b_22*b_32 + (1.0/60.0)*std::pow(b_23, 2) + (1.0/30.0)*b_23*b_33 + (1.0/60.0)*std::pow(b_31, 2) + (1.0/60.0)*std::pow(b_32, 2) + (1.0/60.0)*std::pow(b_33, 2));
      // clang-format on
   };

   bool assemble2D() const override
   {
      WALBERLA_ABORT( "Not implemented." );
      return false;
   };
   bool assemble3D() const override
   {
      WALBERLA_ABORT( "Not implemented." );
      return false;
   };
   bool assembly2DDefined() const override
   {
      WALBERLA_ABORT( "Not implemented." );
      return false;
   };
   bool assembly3DDefined() const override
   {
      WALBERLA_ABORT( "Not implemented." );
      return false;
   };
};

} // namespace n1e1
} // namespace hyteg
